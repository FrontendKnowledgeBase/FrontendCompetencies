# Измерение и мониторинг API: Navigation Timing API, window.performance, beacon

Эффективность веб-приложений и их оптимизация требуют глубокого анализа производительности. Для этого разработчики могут использовать несколько встроенных в браузер API, которые помогают измерять и мониторить производительность. Основные из них — это **Navigation Timing API**, **window.performance** и **Beacon API**. Рассмотрим, как они работают и в каких случаях они наиболее полезны.

## Navigation Timing API: измерение времени загрузки страницы

**Navigation Timing API** предоставляет подробную информацию о временных метках, связанных с жизненным циклом загрузки веб-страницы. Он позволяет разработчикам анализировать каждый этап загрузки страницы, начиная от отправки запроса к серверу и заканчивая рендерингом документа.

### Основные характеристики Navigation Timing API
- **Детальная информация о времени загрузки**: API предоставляет данные о разных этапах загрузки страницы, таких как время подключения, время выполнения DNS-запросов и время загрузки ресурса.
- **Диагностика узких мест**: позволяет выявить проблемы, связанные с медленным подключением, задержками в DNS, долгими запросами на сервер и другими задержками.

### Пример использования Navigation Timing API
```javascript
window.addEventListener('load', () => {
  const timing = window.performance.timing;
  const pageLoadTime = timing.loadEventEnd - timing.navigationStart;
  console.log(`Page load time is ${pageLoadTime} ms`);
});
```

### Когда использовать Navigation Timing API?
**Navigation Timing API** полезен для диагностики и анализа производительности веб-страницы, особенно если необходимо детализированное представление о каждом этапе загрузки.

## window.performance: контроль и анализ производительности

**window.performance** — это глобальный объект, который предоставляет доступ к различным характеристикам производительности текущего документа. Он включает несколько методов и свойств, которые можно использовать для измерения времени выполнения различных операций.

### Основные возможности window.performance
- **Метрики времени**: метод `performance.now()` позволяет измерять время с высокой точностью, что полезно для точных измерений операций внутри страницы.
- **Производительность ресурсов**: `performance.getEntriesByType('resource')` возвращает информацию о всех загруженных ресурсах (таких как изображения, стили и скрипты).

### Пример использования window.performance
```javascript
// Измерение времени выполнения функции
const start = performance.now();

// Некоторая операция
for (let i = 0; i < 1000000; i++) {
  // Выполнение работы
}

const end = performance.now();
console.log(`Операция заняла ${end - start} ms`);
```

### Когда использовать window.performance?
**window.performance** полезен для анализа времени выполнения операций на стороне клиента и измерения производительности загрузки ресурсов. Это дает разработчикам возможность находить узкие места и оптимизировать их.

## Beacon API: надежная отправка данных на сервер

**Beacon API** позволяет отправлять данные на сервер асинхронно и надёжно, даже если пользователь покидает страницу. Это делает Beacon особенно полезным для отправки аналитических данных или данных мониторинга, которые не должны прерывать пользовательский опыт.

### Основные характеристики Beacon API
- **Надёжная отправка данных**: API гарантирует, что данные будут отправлены, даже если пользователь закрыл вкладку или ушел с текущей страницы.
- **Минимальное влияние на производительность**: Beacon использует асинхронную отправку, что не блокирует выполнение страницы.

### Пример использования Beacon API
```javascript
const data = { userId: '12345', event: 'page_exit' };
navigator.sendBeacon('https://analytics.example.com/track', JSON.stringify(data));
```

### Когда использовать Beacon API?
**Beacon API** полезен для отправки аналитических данных, данных о взаимодействиях пользователя или отчётов о сбоях. Он идеально подходит для ситуаций, когда важно гарантировать отправку данных, даже если пользователь покидает страницу.

## Сравнение Navigation Timing API, window.performance и Beacon API

| Характеристика                        | Navigation Timing API    | window.performance       | Beacon API               |
|---------------------------------------|--------------------------|--------------------------|--------------------------|
| **Основная цель**                     | Измерение времени загрузки | Анализ производительности | Надежная отправка данных |
| **Детализация информации**            | Этапы загрузки страницы  | Время выполнения операций | Отправка данных на сервер|
| **Подходит для аналитики**            | Да                       | Да                       | Да                       |
| **Асинхронность**                     | Нет                      | Да                       | Да                       |
| **Надежная отправка при закрытии вкладки** | Нет                    | Нет                      | Да                       |

## Заключение

Для обеспечения отличной производительности веб-приложений важно иметь возможность измерять и анализировать различные аспекты работы страницы. **Navigation Timing API** предоставляет детализированное представление о времени загрузки, **window.performance** позволяет анализировать производительность и время выполнения операций, а **Beacon API** обеспечивает надёжную отправку аналитических данных. Использование этих инструментов в совокупности поможет сделать ваше приложение более быстрым и отзывчивым.

